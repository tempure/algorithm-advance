#include <bits/stdc++.h>
using namespace std;


/*
å¯¹é¡¶å †åŠ¨æ€ç»´æŠ¤ä¸­ä½æ•°ï¼Œå•è¯æ“ä½œO(log)

å·¦è¾¹å¼€ä¸€ä¸ªå°æ ¹å †ï¼Œå³è¾¹å¼€ä¸€ä¸ªå¤§æ ¹å †
1.å·¦è¾¹æ‰€æœ‰å…ƒç´ éƒ½å¤§äºå³è¾¹æ‰€æœ‰å…ƒç´ 
2.å³è¾¹å †å¤§å°>=å·¦è¾¹+1ï¼Œæ­¤æ—¶å³è¾¹å †é¡¶å°±æ˜¯ä¸­ä½æ•°

å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªğŸ¥¾|ğŸ¥¿çš„å½¢çŠ¶, ä¸­é—´åˆ†å‰²å¤„æ˜¯2ä¸ªå †çš„å †é¡¶
ç»´æŠ¤:å‡è®¾å½“å‰æ’å…¥xï¼Œå¦‚æœå³è¾¹ä¸ºç©ºï¼Œæˆ–è€…xå°äºå³è¾¹å †é¡¶ï¼Œé‚£ä¹ˆæ’å…¥å³è¾¹,ä¸ºç©ºæ’å…¥æ˜¯ä¸ºäº†æ»¡è¶³åˆå§‹å³è¾¹ä¸ªæ•°å¤§ï¼Œå¦åˆ™æ’å…¥å·¦è¾¹
æŒ‰ç…§å¤§å°æ’å…¥ä¹‹åé‡æ–°è°ƒæ•´2ä¸ªå †çš„å¤§å°ï¼Œå¦‚æœå³è¾¹å¤§äºå·¦è¾¹+1å¤§å°ï¼Œé‚£ä¹ˆå³è¾¹å †é¡¶æ’å…¥åˆ°å·¦è¾¹ï¼Œå³å †é¡¶å¼¹å‡º
å¦‚æœå·¦è¾¹å…ƒç´ ä¸ªæ•°å¤§äºå³è¾¹ï¼Œé‚£ä¹ˆå·¦å †é¡¶å¼¹å‡ºï¼Œæ’å…¥å³è¾¹ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœ2ä¸ªå †å¤§å°ç›¸åŒï¼Œè¯´æ˜å½“å‰æ˜¯å¶æ•°ä¸ªæ•°ï¼Œä¸‹ä¸€ä¸ªå…ƒç´ å¯èƒ½
å¤§äºå³å †é¡¶ï¼Œé‚£ä¹ˆæ’å…¥åˆ°å·¦è¾¹ï¼Œå·¦è¾¹=å³è¾¹ä¸ªæ•°+1ï¼Œæ­¤æ—¶è°ƒæ•´åå³è¾¹=å·¦è¾¹+1ï¼Œæ°å¥½ç»´æŠ¤ã€‚
*/

int main() {
    int t; cin >> t;
    while (t --) {
        int kase, n;
        cin >> kase >> n;

        cout << kase << ' ' << (n + 1) / 2 << endl;

        priority_queue<int> right;
        priority_queue<int, vector<int>, greater<int> > left;

        int cnt = 0; //è¾“å‡ºè®¡æ•°å™¨ 10ä¸ªå°±æ¢è¡Œ

        for (int i = 1; i <= n; i++) {
            int x; cin >> x;
            if (right.empty() || x < right.top()) right.push(x);
            else left.push(x);

            if (right.size() > left.size() + 1) left.push(right.top()), right.pop();
            if (left.size() > right.size()) right.push(left.top()), left.pop();

            if (i & 1) {
                cout << right.top() << ' ';
                if (++cnt % 10 == 0) puts("");
            }
        }
        if (cnt % 10) puts(""); //æœ«å°¾ä¸è¶³10ä¸ªï¼Œå°±è¦è¾“å‡ºå›è½¦ï¼Œå¦‚æœå·²ç»10ä¸ªï¼Œä¸Šè¾¹å·²ç»è¾“å‡ºå°±ä¸ç”¨äº†
    }
    return 0;
}